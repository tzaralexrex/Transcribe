# Универсальный скрипт транскрибации и перевода аудио/видео  

Этот скрипт позволяет транскрибировать аудио и видео файлы с помощью нескольких движков, а также переводить текст на выбранный язык. Поддерживаются Whisper, Vosk и GPT для транскрибации, а также Whisper, Google Translate и Deepl для перевода.  

---

## Особенности  

- Транскрибация видео и аудио файлов в текст.  
- Вывод в форматах **SRT** (с таймкодами) и **TXT** (полный текст).  
- Поддержка больших файлов через **разбиение на чанки**.  
- Интеграция с OpenAI GPT для транскрибации и перевода.  
- Локальные движки Whisper и Vosk.  
- Выбор переводчика: Whisper, Google Translate, Deepl.  
- Логирование в файл `debug.log`.  
- Настройка длительности чанка, языков и форматов вывода через CLI.  

---

## Требования  

- Python 3.9+  
- ffmpeg (`ffmpeg` должен быть доступен в PATH)  
- Пакеты Python:  

pip install openai-whisper ffmpeg-python googletrans deepl openai vosk  

Для GPT:  

OpenAI API ключ (https://platform.openai.com/account/api-keys)   

Установите переменную окружения OPENAI_API_KEY.  

Для Deepl:  

DeepL API ключ (https://www.deepl.com/pro-api)  

Установите переменную окружения DEEPL_AUTH_KEY.  

Для Vosk:  

Скачайте и распакуйте оффлайн модель: https://alphacephei.com/vosk/models  

Пример модели: vosk-model-small-ru-0.22  

## Использование  

### CLI  

python transcribe_translate.py <input_file> [options]  

### Аргументы  
  
input_file — путь к аудио или видео файлу.  

-e, --engine — движок транскрибации: whisper, vosk, gpt (по умолчанию whisper).  

-m, --model — размер модели Whisper: small, medium, large (по умолчанию small).  

-t, --task — задача: transcribe или translate (по умолчанию translate).  

-l, --language — язык перевода (ISO 639-1), по умолчанию ru.  

-tr, --translator — переводчик: whisper, google, deepl (по умолчанию whisper).  

-f, --formats — форматы вывода через запятую: srt,txt (по умолчанию оба).  

-c, --chunk — длительность чанка в секундах для больших файлов (по умолчанию 600.0).  

# Пример использования  

## Транскрибация и перевод видео на русский с Whisper, вывод в SRT и TXT  
python transcribe_translate.py "video.mp4" -e whisper -l ru -f srt,txt  

## Транскрибация через GPT и перевод на английский  
python transcribe_translate.py "video.mp4" -e gpt -l en -f txt  

## Использование Vosk для оффлайн транскрибации, перевод Deepl  
python transcribe_translate.py "audio.wav" -e vosk -tr deepl -l ru -f srt  

## Логирование  

Все шаги обрабатываются с логированием в файл debug.log.  

Можно включить/выключить логирование и задать режим: создавать новый файл или дописывать к существующему.  

## Настройки находятся в начале скрипта:  

ENABLE_LOG = True  
LOG_FILE = "debug.log"  
LOG_MODE_APPEND = True  

## Примечания  

Для больших видео рекомендуется использовать разбиение на чанки, чтобы API не обрезал длинные файлы.  

Тайминги SRT корректируются автоматически при использовании чанков.  

Скрипт работает с видео и аудио файлами любых форматов, поддерживаемых ffmpeg.  

Если отсутствует нужный движок или переводчик, скрипт выдает предупреждение и инструкции.  

Можно комбинировать движки и переводчики для гибкой обработки.  

## Лицензия  

Этот проект предоставляется "как есть". Пользуйтесь на свой страх и риск. Автор не несет ответственности за использование API и сторонних сервисов.  
